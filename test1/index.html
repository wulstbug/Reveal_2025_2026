<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="/Reveal_2025_2026/dist/reset.css">
		<link rel="stylesheet" href="/Reveal_2025_2026/dist/reveal.css">
		<link rel="stylesheet" href="/Reveal_2025_2026/dist/theme/white.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="/Reveal_2025_2026/plugin/highlight/monokai.css">
		<!-- Font awesome is required for the chalkboard plugin -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
		<!-- Custom controls plugin is used to for opening and closing annotation modes. -->
		<script src="https://cdn.jsdelivr.net/npm/reveal.js-plugins@latest/customcontrols/plugin.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-plugins@latest/customcontrols/style.css">
		<!-- Chalkboard plugin -->
		<script src="https://cdn.jsdelivr.net/npm/reveal.js-plugins@latest/chalkboard/plugin.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-plugins@latest/chalkboard/style.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>Chalk1</section>
				<section>Notes2</section>
				<section>
					<div style="position: relative; width: 100%; height: 80vh;">
						<iframe src="https://liascript.github.io/nightly/?https://raw.githubusercontent.com/wulstbug/Klotzsche2/2025_2026/01_Physik/LK.12_2025_2026/LK12_Script.md"
								style="position: absolute; top: 0; left: 0;
									width: 100%; height: 100%; border: none;">
						</iframe>
					</div>
				</section>
			</div>
		</div>
		<button id="export-chalkboard-image" style="
			position: fixed;
			top: 4em;
			right: 1em;
			z-index: 1000;
			padding: 0.5em 1em;
			font-size: 1em;
			border: none;
			border-radius: 5px;
			background-color: #28a745;
			color: white;
			cursor: pointer;
		">
		Save2
		</button>
		<button id="screenshot-btn" style="
			position: fixed;
			top: 10em;
			right: 1em;
			z-index: 1000;
			padding: 0.5em 1em;
			font-size: 1em;
			border: none;
			border-radius: 5px;
			background-color: #673ab7;
			color: white;
			cursor: pointer;">
			Screenshot speichern
		</button>
		<button id="export-only-chalkboard" style="
			position: fixed;
			top: 13em;
			right: 1em;
			z-index: 1000;
			padding: 0.5em 1em;
			font-size: 1em;
			border: none;
			border-radius: 5px;
			background-color: #009688;
			color: white;
			cursor: pointer;">
			Nur Tafel speichern 2 new
		</button>

		<script src="/Reveal_2025_2026/dist/reveal.js"></script>
		<script src="/Reveal_2025_2026/plugin/notes/notes.js"></script>
		<script src="/Reveal_2025_2026/plugin/markdown/markdown.js"></script>
		<script src="/Reveal_2025_2026/plugin/highlight/highlight.js"></script>

		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				//chalkboard
				customcontrols: {
					controls: [
					{ icon: '<i class="fa fa-pen-square"></i>',
						title: 'Toggle chalkboard (B)',
						action: 'RevealChalkboard.toggleChalkboard();'
					},
					{ icon: '<i class="fa fa-pen"></i>',
						title: 'Toggle notes canvas (C)',
						action: 'RevealChalkboard.toggleNotesCanvas();'
					}
					]
				},
				chalkboard: {
					// add configuration here
				},
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealChalkboard, RevealCustomControls ]
			});
			document.getElementById("export-chalkboard-image").addEventListener("click", function () {
				const plugin = Reveal.getPlugin("RevealChalkboard");
				if (!plugin) {
				alert("Chalkboard-Plugin nicht gefunden.");
				return;
				}

				// Finde aktives Canvas
				const canvases = document.querySelectorAll(".chalkboard-canvas");
				let visibleCanvas = null;

				canvases.forEach(c => {
				const style = getComputedStyle(c);
				if (style.display !== "none" && c.offsetParent !== null) {
					visibleCanvas = c;
				}
				});

				if (!visibleCanvas) {
				alert("Kein aktives Chalkboard-Canvas gefunden. DrÃ¼cke 'w' oder 'c' zum Aktivieren.");
				return;
				}

				const dataUrl = visibleCanvas.toDataURL("image/png");

				// Download starten
				const a = document.createElement("a");
				a.href = dataUrl;
				a.download = "chalkboard-export.png";
				a.click();
			});
		</script>		
		<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
		<script>
			document.getElementById("screenshot-btn").addEventListener("click", () => {
				const target = document.querySelector(".reveal");

				html2canvas(target, {
				useCORS: true,
				backgroundColor: "#ffffff" // optional fÃ¼r weiÃŸe Slides
				}).then(canvas => {
				const link = document.createElement("a");
				link.href = canvas.toDataURL("image/png");
				link.download = "reveal-screenshot.png";
				link.click();
				}).catch(err => {
				alert("Screenshot fehlgeschlagen ðŸ˜¢");
				console.error(err);
				});
			});
		</script>
		<script>
			document.getElementById("export-only-chalkboard").addEventListener("click", () => {
				const chalk = Reveal.getPlugin("RevealChalkboard");
				if (!chalk) {
				alert("Chalkboard-Plugin nicht geladen.");
				return;
				}

				// Hol das aktuell aktive Zeichen-Canvas direkt vom Plugin
				const canvas = chalk.canvas; // dies ist das richtige Canvas-Objekt
				if (!canvas || !canvas.getContext) {
				alert("Kein aktives Chalkboard gefunden â€“ bitte zuerst 'w' oder 'c' drÃ¼cken.");
				return;
				}

				try {
				const dataURL = canvas.toDataURL("image/png");

				const link = document.createElement("a");
				link.href = dataURL;
				link.download = "tafel-export.png";
				link.click();
				} catch (err) {
				console.error("Fehler beim PNG-Export:", err);
				alert("Export fehlgeschlagen ðŸ˜¢");
				}
			});
		</script>
	</body>
</html>
